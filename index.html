<html>

<head>
  <title>Steganography Online</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
</head>

<body>
  <div class="container">
    <div class="page-header">
      <h1>Steganography</h1>
    </div>

    <ul class="nav nav-tabs" id="tabs" data-tabs="tabs">
      <li role="presentation"> <a href="#home" data-toggle="tab">Home</a></li>
      <li role="presentation"> <a href="#encode" data-toggle="tab">Encode</a></li>
      <li role="presentation"> <a href="#decode" data-toggle="tab">Decode</a></li>
      <li role="presentation"> <a href="#demo" data-toggle="tab">Demo</a></li>
      <li role="presentation"> <a href="#counter" data-toggle="tab">Counter Measure</a></li>
    </ul>

    <div id="my-tab-content" class="tab-content">

      <div class="tab-pane active" id="home">
        <br>

        <h2>What is Steganography?</h2>
        <h4>Steganography is the practice of hiding a secret message inside of (or even on top of) something that is not
          secret. That something can be just about anything you want. These days, many examples of steganography involve
          embedding a secret piece of text inside of a picture. Or hiding a secret message or script inside of a Word or
          Excel document.

          The purpose of steganography is to conceal and deceive. It is a form of covert communication and can involve
          the use of any medium to hide messages. It’s not a form of cryptography, because it doesn’t involve scrambling
          data or using a key. Instead, it is a form of data hiding and can be executed in clever ways. Where
          cryptography is a science that largely enables privacy, steganography is a practice that enables secrecy – and
          deceit.</h4>

        <h2>How Steganography is Used Today</h2>
        <h4>Steganography has been used for centuries, but these days, hackers and IT pros have digitized it to do some
          pretty creative things. There are a number of apps that can be used for steganography, including Steghide,
          Xiao, Stegais and Concealment.

          The word steganography seems fancy, but it actually comes from a fairly normal place. The root “steganos” is
          Greek for “hidden” or “covered,” and the root “graph” is Greek for “to write.” Put these words together, and
          you’ve got something close to “hidden writing” or “secret writing.”

          Here’s an example of how digital steganography works. A friend of mine sent me a steganographic message – a
          secret message embedded within an image.</h4>
        <h2>Using Steganography to Deliver Attacks</h2>
        <h4>Today, attackers use PowerShell and BASH scripts to automate attacks. So are pen testers. For example,
          attackers have been embedding actual scripts within macro-enabled Excel and Word documents. Once a victim
          opens the Excel or Word doc, they activate the embedded, secret script.

          The attacker doesn’t need to trick the user into using applications such as Steghide. In this case, the hacker
          – or pen tester – is “living off the land.” The attacker is using a steganographic application to take
          advantage of common Windows applications and features such as Excel and PowerShell. All the victim needs to do
          is read the doc, and an unfortunate series of events begins to occur.

          First, the victim clicks on an Excel document that an attacker has modified using steganography.
          That click unleashes a hidden PowerShell script.
          This script then installs an installer app into the Windows computer. This installer app moves quickly and is
          so subtle that typical antivirus applications don’t notice it.
          This downloader then goes out to the internet and grabs updated versions of malware such as URLZone (or more
          recent tools) that then compromise the victim’s computer.
          Over the years, attackers have used the procedure above to deliver ransomware such as Snatch. Hackers have
          installed sophisticated malware that is cable of keylogging, enlisting computers into DDoS botnets or
          installing trojans, such as the latest variants of Rovnix and Pillowmint. The list goes on.</h4>
        <h2>Artificial Intelligence and Steganography</h2>
        <h4>We’re also seeing attackers add artificial intelligence (AI) into the mix. Increasingly, we’re seeing AI
          uses of various tactics, including steganography, to hide information. AI implementations have even been able
          to modify steganographic techniques so that attacks can’t be easily discovered.</h4>
        <h2>Detecting Steganography</h2>
        <h4>Security analysts work to identify the tactics, techniques and procedures (TTPs) of attackers and pen
          testers. Over the years, they have identified typical signatures that steganographic applications use. This is
          why antivirus applications, for example, can identify typical moves made by steganographic applications.

          Therefore, pen testers and attackers morph and modify their procedures to thwart detection. And so the cat and
          mouse game continues: Attackers constantly modify tools and techniques, and security analysts constantly look
          for new signatures and methods.</h4>
      </div>


      <div class="tab-pane" id="encode">
        <div>
          <h2>Encode message</h2>
          <p class="alert alert-info">
            To encode a message into an image, choose the image you want to use, enter your text and hit the
            <strong>Encode</strong> button. <br />
            Save the last image, it will contain your hidden message. <br />
            Remember, the more text you want to hide, the larger the image has to be. In case you chose an image that is
            too small to hold your message you will be informed.<br /><br />
            Neither the image nor the message you hide will be at any moment transmitted over the web, all the magic
            happens within your browser.
          </p>
          <form class="form">
            <div class="form-group">
              <input class="form-control" type="file" name="baseFile" onchange="previewEncodeImage()">
            </div>

            <div class="form-group">
              <textarea class="form-control message" rows="3" placeholder="Enter your message here"></textarea>
            </div>

            <div class="form-group">
              <button class="encode btn btn-default pull-right" onclick="encodeMessage()">Encode</button>
            </div>
          </form>
          <div class="clearfix"></div>
        </div>

        <div class="error" style="display: none;"></div>
        <div class="binary" style="display: none;">
          <h3>Binary representation of your message</h3>
          <textarea class="form-control message" style="word-wrap:break-word;">
          </textarea>
        </div>
        <div class="images" style="display: none;">
          <div class="original" style="display: none;">
            <h3>Original</h3>
            <canvas></canvas>
          </div>
          <div class="nulled" style="display: none;">
            <h3>Normalized</h3>
            <canvas></canvas>
          </div>
          <div class="message" style="display: none;">
            <h3>Message hidden in image (right click <span class="glyphicon glyphicon-arrow-right"></span> save as)</h3>
            <canvas></canvas>
          </div>
        </div>
      </div>

      <div class="tab-pane" id="demo">

      </div>
      <div class="tab-pane" id="decode">
        <div>
          <h2>Decode image</h2>
          <p class="alert alert-info">
            To decode a hidden message from an image, just choose an image and hit the <strong>Decode</strong>
            button.<br /><br />
            Neither the image nor the message that has been hidden will be at any moment transmitted over the web, all
            the magic happens within your browser.
          </p>
          <form class="form">
            <div class="form-group">
              <input class="form-control" type="file" name="decodeFile" onchange="previewDecodeImage()">
            </div>
            <div class="form-group">
              <button class="decode btn btn-default pull-right" onclick="decodeMessage()">Decode</button>
            </div>
          </form>
          <div class="clearfix"></div>
        </div>
        <div class="binary-decode" style="display: none;">
          <h3>Hidden message</h3>
          <textarea class="form-control message" style="word-wrap:break-word;">
          </textarea>
        </div>
        <div class="decode" style="display: none;">
          <h3>Input</h3>
          <canvas></canvas>
        </div>
      </div>


      <div class="tab-pane" id="counter">
        <div>
          <h2>Counter Measures</h2>
          <p class="alert alert-info">
            In computing, detection of steganographically encoded packages is called steganalysis. The simplest method
            to detect files that may have been modified to send steganographic messages is to compare the files to
            known, clean originals of the files. For example, if one wanted to see if a website had been modified to
            hide a message in it's image files, one could compare the image files currently on the site with the
            original files intended to be there.

          </p>
          <input type="file" id="inputImg" />
          <br><br>
          Name of file <input type="text" id="nameImg" style="width: 100%" />
          <br><br>
          Type file <input type="text" id="typeImg" style="width: 100%" />
          <br><br>
          Size file <input type="text" id="sizeImg" style="width: 100%" />
          <br><br>
          <!-- base64Img: <input type="text" id="base64Url" style="width: 100%" /> -->
          base64Img: <textarea rows="5" cols="80" id="base64Url" style="width: 100%"></textarea>
          <br>

          <br>
          <!-- binaryImg:
          <br>
          <pre id="binaryImg" style="background: #fff; border: 1px solid #777; padding: 10px"></pre>
          <br>
          <input type="submit" id="saveImg" value="Save & Download" /> -->

          <script type="text/javascript">
            var blobURL;
            var fileName;

            // Convert a base64 string into a binary Uint8 Array 
            // https://gist.github.com/borismus/1032746
            function convertDataURIToBinary(dataURI) {
              var BASE64_MARKER = ';base64,';
              var base64Index = dataURI.indexOf(BASE64_MARKER) + BASE64_MARKER.length;
              var base64 = dataURI.substring(base64Index);
              var raw = window.atob(base64);
              var rawLength = raw.length;
              var array = new Uint8Array(new ArrayBuffer(rawLength));

              for (i = 0; i < rawLength; i++) {
                array[i] = raw.charCodeAt(i);
              }
              return array;
            }

            // File Reader
            // https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsDataURL
            function readFile(evt) {
              var f = evt.target.files[0];

              if (f) {
                if (/(jpe?g|png|gif)$/i.test(f.type)) {
                  var r = new FileReader();
                  r.onload = function (e) {
                    var base64Img = e.target.result;
                    var binaryImg = convertDataURIToBinary(base64Img);
                    var blob = new Blob([binaryImg], { type: f.type });
                    blobURL = window.URL.createObjectURL(blob);
                    fileName = f.name;
                    document.getElementById('nameImg').value = fileName;
                    document.getElementById('typeImg').value = f.type;
                    document.getElementById('sizeImg').value = f.size;
                    document.getElementById('base64Url').value = base64Img;
                    document.getElementById('blobUrl').value = blobURL;
                    document.getElementById('base64Img').src = base64Img;
                    document.getElementById('blobImg').src = blobURL;
                    document.getElementById('binaryImg').innerHTML = JSON.stringify(binaryImg, null, 2);
                  }
                  r.readAsDataURL(f);
                } else {
                  alert("Failed file type");
                }
              } else {
                alert("Failed to load file");
              }
            }

            var downloadFile = (function () {
              var a = document.createElement("a");
              document.body.appendChild(a);
              a.style = "display: none";
              return function () {
                a.href = blobURL;
                a.download = fileName;
                a.click();
                window.URL.revokeObjectURL(blobURL);
              };
            }());

            document.getElementById('inputImg').addEventListener('change', readFile, false);
            document.getElementById('saveImg').addEventListener('click', downloadFile, false);
          </script>
        </div>




      </div>
      <div class="decode" style="display: none;">
      </div>
    </div>

  </div>

  </div>

  <style>
    canvas {
      max-width: 100%;
    }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script type="text/JavaScript" src="script.js"></script>
</body>

</html>